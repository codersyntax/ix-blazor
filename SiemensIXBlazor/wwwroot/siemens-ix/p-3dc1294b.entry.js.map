{"version":3,"names":["createEnterLeaveDebounce","enterCallback","leaveCallback","debounceTimeEnter","debounceTimeLeave","enterTimeout","leaveTimeout","onEnter","clearTimeout","setTimeout","onLeave","menuCategoryCss","IxMenuCategoryStyle0","DefaultIxMenuItemHeight","DefaultAnimationTimeout","MenuCategory","this","enterLeaveDebounce","onPointerEnter","onPointerLeave","isNestedItemActive","getNestedItems","some","item","active","Array","from","hostElement","querySelectorAll","getNestedItemsHeight","items","length","onExpandCategory","showItems","animateFadeIn","animateFadeOut","slotHideThresholdMs","anime","targets","menuItemsContainer","duration","easing","opacity","maxHeight","complete","showDropdown","begin","ixMenu","expand","closeOtherCategories","emit","onCategoryClick","e","stopPropagation","onNestedItemsChanged","nestedItems","isCategoryItemListVisible","menuExpand","componentWillLoad","closestMenu","closestIxMenu","Error","componentDidLoad","observer","createMutationObserver","observe","attributes","childList","subtree","requestAnimationFrame","addEventListener","detail","clearMenuItemStyles","style","removeProperty","disconnectedCallback","disconnect","render","h","Host","key","class","expanded","event","pointerType","notifications","icon","onClick","onFocus","isCategory","label","name","ref","closeBehavior","show","onShowChanged","dropdownShown","anchor","placement","offset","mainAxis","target","HTMLElement","tagName","preventDefault","variant","color"],"sources":["src/components/menu-category/enter-leave.ts","src/components/menu-category/menu-category.scss?tag=ix-menu-category&encapsulation=shadow","src/components/menu-category/menu-category.tsx"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2024 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nexport function createEnterLeaveDebounce(\n  enterCallback: Function,\n  leaveCallback: Function,\n  {\n    debounceTimeEnter,\n    debounceTimeLeave,\n  }: {\n    debounceTimeEnter: number;\n    debounceTimeLeave: number;\n  } = {\n    debounceTimeEnter: 0,\n    debounceTimeLeave: 500,\n  }\n) {\n  let enterTimeout: NodeJS.Timeout;\n  let leaveTimeout: NodeJS.Timeout;\n\n  return {\n    onEnter: () => {\n      clearTimeout(leaveTimeout);\n      enterTimeout = setTimeout(() => {\n        enterCallback();\n      }, debounceTimeEnter);\n    },\n    onLeave: () => {\n      clearTimeout(enterTimeout);\n      leaveTimeout = setTimeout(() => {\n        leaveCallback();\n      }, debounceTimeLeave);\n    },\n  };\n}\n","/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n@import 'mixins/shadow-dom/component';\n@import 'mixins/text-truncation';\n\n:host {\n  @include ix-component;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n\n  .category {\n    display: flex;\n    position: relative;\n    align-items: center;\n    width: 100%;\n    height: 100%;\n  }\n\n  .category-text {\n    width: 100%;\n    padding-right: 0.25rem;\n    @include ellipsis;\n  }\n\n  .category-chevron {\n    margin-left: auto;\n    margin-right: 0;\n    transition: var(--theme-default-time) transform ease-in-out;\n  }\n\n  .category-chevron--open {\n    transform: rotate(-180deg);\n  }\n\n  .menu-items {\n    overflow: hidden;\n    max-height: 0;\n    transition: var(--theme-default-time) max-height ease-in-out;\n  }\n\n  .menu-items--expanded {\n    max-height: 999999999px;\n    padding: 0.25rem 0 0.25rem 1.625rem;\n  }\n\n  .menu-items--collapsed {\n    display: none;\n  }\n\n  .category-dropdown {\n    ::slotted(ix-menu-item) {\n      --ix-menu-item-height: 2.5rem;\n    }\n  }\n\n  .category-dropdown-header {\n    pointer-events: none;\n    padding-left: 0.125rem;\n    min-width: 256px;\n  }\n\n  ::slotted(ix-menu-item) {\n    --ix-menu-item-height: 2.5rem;\n  }\n}\n\n:host(.expanded) {\n  background-color: var(--theme-color-ghost--active);\n}\n\n:host {\n  ::slotted(a[href]) {\n    text-decoration: none !important;\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport {\n  Component,\n  Element,\n  h,\n  Host,\n  Prop,\n  State,\n  Event,\n  EventEmitter,\n  Listen,\n} from '@stencil/core';\nimport anime from 'animejs';\nimport { closestIxMenu } from '../utils/application-layout/context';\nimport { createMutationObserver } from '../utils/mutation-observer';\nimport { createEnterLeaveDebounce } from './enter-leave';\n\nconst DefaultIxMenuItemHeight = 40;\nconst DefaultAnimationTimeout = 150;\n\n/**\n * @since 2.0.0\n */\n@Component({\n  tag: 'ix-menu-category',\n  styleUrl: 'menu-category.scss',\n  shadow: true,\n})\nexport class MenuCategory {\n  @Element() hostElement: HTMLIxMenuCategoryElement;\n\n  /**\n   * Display name of the category\n   */\n  @Prop() label: string;\n\n  /**\n   * Icon of the category\n   */\n  @Prop() icon: string;\n\n  /**\n   * Show notification count on the category\n   */\n  @Prop() notifications: number;\n\n  /** @internal */\n  // eslint-disable-next-line @stencil-community/decorators-style\n  @Event({ bubbles: true, cancelable: true })\n  closeOtherCategories: EventEmitter;\n\n  @State() menuExpand = false;\n  @State() showItems = false;\n  @State() showDropdown = false;\n  @State() nestedItems: HTMLIxMenuItemElement[] = [];\n\n  private observer: MutationObserver;\n  private menuItemsContainer: HTMLDivElement;\n  private ixMenu: HTMLIxMenuElement;\n\n  private enterLeaveDebounce = createEnterLeaveDebounce(\n    () => {\n      this.onPointerEnter();\n    },\n    () => {\n      this.onPointerLeave();\n    }\n  );\n\n  private isNestedItemActive() {\n    return this.getNestedItems().some((item) => item.active);\n  }\n\n  private getNestedItems() {\n    return Array.from(\n      this.hostElement.querySelectorAll(':scope ix-menu-item')\n    ) as HTMLIxMenuItemElement[];\n  }\n\n  private getNestedItemsHeight() {\n    const items = this.getNestedItems();\n\n    return items.length * DefaultIxMenuItemHeight;\n  }\n\n  private onExpandCategory(showItems: boolean) {\n    if (showItems) {\n      this.animateFadeIn();\n    } else {\n      this.animateFadeOut();\n    }\n  }\n\n  private animateFadeOut() {\n    const slotHideThresholdMs = 25;\n    anime({\n      targets: this.menuItemsContainer,\n      duration: DefaultAnimationTimeout,\n      easing: 'easeInSine',\n      opacity: [1, 0],\n      maxHeight: [this.getNestedItemsHeight() + DefaultIxMenuItemHeight, 0],\n      complete: () => {\n        setTimeout(() => {\n          this.showItems = false;\n          this.showDropdown = false;\n        }, DefaultAnimationTimeout + slotHideThresholdMs);\n      },\n    });\n  }\n\n  private animateFadeIn() {\n    anime({\n      targets: this.menuItemsContainer,\n      duration: DefaultAnimationTimeout,\n      easing: 'easeInSine',\n      opacity: [0, 1],\n      maxHeight: [0, this.getNestedItemsHeight() + DefaultIxMenuItemHeight],\n      begin: () => {\n        this.showItems = true;\n        this.showDropdown = false;\n      },\n    });\n  }\n\n  private onPointerEnter() {\n    if (this.ixMenu.expand) {\n      return;\n    }\n    this.closeOtherCategories.emit();\n    this.showDropdown = true;\n  }\n\n  @Listen('closeOtherCategories', { target: 'window' })\n  private onPointerLeave() {\n    this.showDropdown = false;\n  }\n\n  private onCategoryClick(e: MouseEvent) {\n    e.stopPropagation();\n    if (this.ixMenu.expand) {\n      e?.stopPropagation();\n      this.onExpandCategory(!this.showItems);\n      return;\n    }\n  }\n\n  private onNestedItemsChanged() {\n    this.nestedItems = this.getNestedItems();\n  }\n\n  private isCategoryItemListVisible() {\n    return this.menuExpand && (this.showItems || this.isNestedItemActive());\n  }\n\n  componentWillLoad() {\n    const closestMenu = closestIxMenu(this.hostElement);\n    if (!closestMenu) {\n      throw Error('ix-menu-category can only be used as a child of ix-menu');\n    }\n    this.ixMenu = closestMenu;\n\n    this.menuExpand = this.ixMenu.expand;\n    this.showItems = this.isCategoryItemListVisible();\n  }\n\n  componentDidLoad() {\n    this.observer = createMutationObserver(() => this.onNestedItemsChanged());\n    this.observer.observe(this.hostElement, {\n      attributes: true,\n      childList: true,\n      subtree: true,\n    });\n\n    requestAnimationFrame(() => {\n      this.onNestedItemsChanged();\n    });\n\n    this.ixMenu.addEventListener(\n      'expandChange',\n      ({ detail: menuExpand }: CustomEvent<boolean>) => {\n        this.menuExpand = menuExpand;\n        if (!menuExpand) {\n          this.clearMenuItemStyles();\n        }\n        this.showItems = this.isCategoryItemListVisible();\n      }\n    );\n  }\n\n  clearMenuItemStyles() {\n    this.menuItemsContainer.style.removeProperty('max-height');\n    this.menuItemsContainer.style.removeProperty('opacity');\n  }\n\n  disconnectedCallback() {\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  }\n\n  render() {\n    return (\n      <Host\n        class={{\n          expanded: this.showItems,\n        }}\n        onPointerEnter={() => {\n          this.enterLeaveDebounce.onEnter();\n        }}\n        onPointerLeave={(event: PointerEvent) => {\n          if (event.pointerType === 'touch') {\n            return;\n          }\n          this.enterLeaveDebounce.onLeave();\n        }}\n      >\n        <ix-menu-item\n          class={'category-parent'}\n          active={this.isNestedItemActive()}\n          notifications={this.notifications}\n          icon={this.icon}\n          onClick={(e) => this.onCategoryClick(e)}\n          onFocus={() => this.onPointerEnter()}\n          isCategory\n        >\n          <div class=\"category\">\n            <div class=\"category-text\">{this.label}</div>\n            <ix-icon\n              name={'chevron-down-small'}\n              class={{\n                'category-chevron': true,\n                'category-chevron--open': this.showItems,\n              }}\n            ></ix-icon>\n          </div>\n        </ix-menu-item>\n        <div\n          ref={(ref) => (this.menuItemsContainer = ref!)}\n          class={{\n            'menu-items': true,\n            'menu-items--expanded': this.showItems,\n            'menu-items--collapsed': !this.showItems,\n          }}\n        >\n          {this.showItems ? <slot></slot> : null}\n        </div>\n        <ix-dropdown\n          closeBehavior={'both'}\n          show={this.showDropdown}\n          onShowChanged={({ detail: dropdownShown }: CustomEvent<boolean>) => {\n            this.showDropdown = dropdownShown;\n          }}\n          class={'category-dropdown'}\n          anchor={this.hostElement}\n          placement=\"right-start\"\n          offset={{\n            mainAxis: 3,\n          }}\n          onClick={(e) => {\n            if (e.target instanceof HTMLElement) {\n              if (e.target.tagName === 'IX-MENU-ITEM') {\n                this.showDropdown = false;\n              } else {\n                e.preventDefault();\n              }\n            }\n          }}\n        >\n          <ix-dropdown-item class={'category-dropdown-header'}>\n            <ix-typography variant=\"default-title-single\" color=\"std\">\n              {this.label}\n            </ix-typography>\n          </ix-dropdown-item>\n          <ix-divider></ix-divider>\n          <slot></slot>\n        </ix-dropdown>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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"}