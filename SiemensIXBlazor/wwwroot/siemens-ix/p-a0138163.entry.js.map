{"version":3,"names":["dateDropdownCss","IxDateDropdownStyle0","DateDropdown","this","datePickerTouched","DateTime","now","toISO","onDateRangeIdChange","onRangeListSelect","dateRangeId","updateCurrentDate","setDateRangeSelection","onDateSelect","from","currentRangeValue","to","id","onDateRangeOptionsChange","initialize","onDisabledChange","disabled","closeDropdown","componentWillLoad","getDateRange","isCustomRange","customRangeAllowed","selectedDateRangeId","isValidConfiguration","console","warn","rangeValue","preserveDropdown","dateRangeChange","emit","option","dateRangeOptions","find","range","hostElement","shadowRoot","querySelector","show","getButtonLabel","_a","i18nNoRange","_b","length","error","label","render","h","Host","key","variant","icon","ref","triggerRef","class","trigger","closeBehavior","placement","onShowChanged","detail","map","dateRangeOption","onClick","checked","hidden","i18nCustomItem","Fragment","standaloneAppearance","onDateChange","e","stopPropagation","Object","assign","onDateRangeChange","format","_c","minDate","maxDate","today","i18nDone"],"sources":["src/components/date-dropdown/date-dropdown.scss?tag=ix-date-dropdown&encapsulation=shadow","src/components/date-dropdown/date-dropdown.tsx"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n@import 'common-variables';\n@import 'mixins/shadow-dom/component';\n\n:host {\n  @include ix-component;\n  display: inline-block;\n  position: relative;\n\n  @media (max-width: 48em) {\n    .min-width {\n      width: min-content;\n    }\n  }\n\n  @media (min-width: 48em) {\n    .border-right {\n      border-right: var(--theme-x-weak-bdr-2);\n    }\n  }\n\n  ix-button {\n    width: 100%;\n  }\n\n  .max-height {\n    max-height: max-content;\n  }\n\n  .no-margin {\n    margin: 0;\n    padding: 0;\n  }\n\n  .pull-right {\n    float: right;\n    padding: $tiny-space $default-space;\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {\n  Component,\n  Element,\n  Event,\n  EventEmitter,\n  Fragment,\n  h,\n  Host,\n  Method,\n  Prop,\n  State,\n  Watch,\n} from '@stencil/core';\nimport { DateTime } from 'luxon';\n\nexport type DateDropdownOption = {\n  id: string;\n  label: string;\n  from: string;\n  to: string;\n};\n\nexport type DateRangeChangeEvent = {\n  id: string;\n  from: string;\n  to: string;\n};\n\n/**\n * @since 2.1.0\n */\n@Component({\n  tag: 'ix-date-dropdown',\n  styleUrl: 'date-dropdown.scss',\n  shadow: true,\n})\nexport class DateDropdown {\n  @Element() hostElement: HTMLIxDateDropdownElement;\n\n  /**\n   * Disable the button that opens the dropdown containing the date picker.\n   *\n   * @since 2.3.0\n   */\n  @Prop() disabled = false;\n\n  /**\n   * Date format string.\n   * See @link https://moment.github.io/luxon/#/formatting?id=table-of-tokens for all available tokens.\n   */\n  @Prop() format = 'yyyy/LL/dd';\n\n  /**\n   * If true a range of dates can be selected.\n   */\n  @Prop() range = true;\n\n  /**\n   * Picker date. If the picker is in range mode this property is the start date.\n   * If set to `null` no default start date will be pre-selected.\n   *\n   * Format is based on `format`\n   */\n  @Prop() from: string;\n\n  /**\n   * Picker date. If the picker is in range mode this property is the end date.\n   * If the picker is not in range mode leave this value `null`\n   *\n   * Format is based on `format`\n   */\n  @Prop() to: string;\n\n  /**\n   * The earliest date that can be selected by the date picker.\n   * If not set there will be no restriction.\n   */\n  @Prop() minDate: string;\n\n  /**\n   * The latest date that can be selected by the date picker.\n   * If not set there will be no restriction.\n   */\n  @Prop() maxDate: string;\n\n  /**\n   * Used to set the initial select date range as well as the button name,\n   * if not set or no according date range label is found, nothing will be selected\n   */\n  @Prop() dateRangeId = 'custom';\n  @Watch('dateRangeId')\n  @Watch('to')\n  @Watch('from')\n  onDateRangeIdChange() {\n    this.onRangeListSelect(this.dateRangeId);\n    this.updateCurrentDate();\n    this.setDateRangeSelection(this.dateRangeId);\n\n    this.onDateSelect({\n      from: this.currentRangeValue.from,\n      to: this.currentRangeValue.to,\n      id: this.currentRangeValue.id,\n    });\n  }\n\n  /**\n   * Controls whether the user is allowed to pick custom date ranges in the component.\n   * When set to 'true', the user can select a custom date range using the date picker.\n   * When set to 'false', only predefined time date ranges are available for selection.\n   */\n  @Prop() customRangeAllowed = true;\n\n  /**\n   * An array of predefined date range options for the date picker.\n   * Each option is an object with a label describing the range and a function\n   * that returns the start and end dates of the range as a DateRangeOption object.\n   *\n   * Example format:\n   *   {\n   *     id: 'some unique id',\n   *     label: 'Name of the range',\n   *     from: undefined, to: '2023/03/29'\n   *   },\n   *   // ... other predefined date range options ...\n   */\n  @Prop() dateRangeOptions: DateDropdownOption[] = [];\n  @Watch('dateRangeOptions')\n  onDateRangeOptionsChange() {\n    this.initialize();\n    this.onDateRangeIdChange();\n  }\n\n  /**\n   * Text for custom dropdown item. Will be used for translation.\n   */\n  @Prop({ attribute: 'i18n-custom-item' }) i18nCustomItem = 'Custom...';\n\n  /**\n   * Text for the done button. Will be used for translation.\n   */\n  @Prop({ attribute: 'i18n-done' }) i18nDone = 'Done';\n\n  /**\n   * Text for the done button. Will be used for translation.\n   */\n  @Prop({ attribute: 'i18n-no-range' }) i18nNoRange = 'No range set';\n\n  /** @internal */\n  @Prop() today = DateTime.now().toISO();\n\n  /**\n   * EventEmitter for date range change events.\n   *\n   * This event is emitted when the date range changes within the component.\n   * The event payload contains information about the selected date range.\n   */\n  @Event() private dateRangeChange: EventEmitter<DateRangeChangeEvent>;\n\n  @State() private selectedDateRangeId: 'custom' | (string & {});\n  @State() private currentRangeValue: {\n    from: string;\n    to: string;\n    id: string;\n  };\n  @State() private triggerRef: HTMLElement;\n\n  @Watch('disabled')\n  onDisabledChange() {\n    if (this.disabled) {\n      this.closeDropdown();\n    }\n  }\n  private datePickerTouched = false;\n\n  componentWillLoad() {\n    this.initialize();\n    this.setDateRangeSelection(this.dateRangeId);\n  }\n\n  /**\n   * Retrieves the currently selected date range from the component.\n   * This method returns the selected date range as a `DateChangeEvent` object.\n   */\n  @Method()\n  public async getDateRange(): Promise<DateRangeChangeEvent> {\n    return this.currentRangeValue;\n  }\n\n  private initialize() {\n    const isCustomRange =\n      this.dateRangeId === 'custom' ||\n      (!this.dateRangeId && !!this.from && !!this.to);\n\n    if (isCustomRange && this.customRangeAllowed) {\n      this.selectedDateRangeId = 'custom';\n      this.updateCurrentDate();\n\n      return;\n    }\n    const isValidConfiguration = !isCustomRange && !this.from;\n    if (!isValidConfiguration) {\n      console.warn(\n        '\"from\" and \"range-date-id\" is provided this is an invalid combination. Using \"custom\".'\n      );\n\n      this.selectedDateRangeId = 'custom';\n      this.updateCurrentDate();\n\n      return;\n    }\n  }\n\n  private updateCurrentDate() {\n    this.currentRangeValue = {\n      id: this.selectedDateRangeId,\n      from: this.from,\n      to: this.to,\n    };\n  }\n\n  private onDateSelect(\n    rangeValue: { from: string; to: string; id: string },\n    preserveDropdown = true\n  ) {\n    this.dateRangeChange.emit(rangeValue);\n\n    if (preserveDropdown) {\n      this.closeDropdown();\n    }\n\n    this.datePickerTouched = false;\n  }\n\n  private onRangeListSelect(id: string) {\n    if (this.setDateRangeSelection(id)) {\n      this.onDateSelect(this.currentRangeValue);\n    }\n  }\n\n  private setDateRangeSelection(id: string) {\n    this.selectedDateRangeId = id;\n    const option = this.dateRangeOptions.find((range) => range.id === id);\n\n    if (option) {\n      this.currentRangeValue = option;\n    }\n\n    return option;\n  }\n\n  private closeDropdown() {\n    this.hostElement.shadowRoot.querySelector('ix-dropdown').show = false;\n  }\n\n  private getButtonLabel() {\n    if (this.selectedDateRangeId === 'custom' && this.currentRangeValue?.from) {\n      let range = this.currentRangeValue.from;\n\n      if (this.currentRangeValue.to) {\n        range += ` - ${this.currentRangeValue.to}`;\n      }\n\n      return range;\n    }\n\n    if (!this.selectedDateRangeId) {\n      return this.i18nNoRange;\n    }\n\n    if (!this.dateRangeOptions || this.dateRangeOptions?.length === 0) {\n      return this.i18nNoRange;\n    }\n\n    const option = this.dateRangeOptions.find(\n      (option) => option.id === this.selectedDateRangeId\n    );\n\n    if (!option) {\n      console.error(\n        `Cannot find range option with id ${this.selectedDateRangeId}`\n      );\n      return this.i18nNoRange;\n    }\n\n    return option.label;\n  }\n\n  render() {\n    return (\n      <Host>\n        <ix-button\n          data-testid=\"date-dropdown-trigger\"\n          data-date-dropdown-trigger\n          variant=\"primary\"\n          icon=\"history\"\n          ref={(ref) => (this.triggerRef = ref)}\n          disabled={this.disabled}\n        >\n          {this.getButtonLabel()}\n        </ix-button>\n        <ix-dropdown\n          data-testid=\"date-dropdown\"\n          data-date-dropdown\n          class=\"min-width max-height\"\n          trigger={this.triggerRef}\n          closeBehavior=\"outside\"\n          placement=\"bottom-start\"\n          onShowChanged={({ detail: show }) => {\n            if (\n              !show &&\n              this.selectedDateRangeId === 'custom' &&\n              this.datePickerTouched\n            ) {\n              this.onDateSelect(this.currentRangeValue);\n            }\n          }}\n        >\n          <ix-layout-grid no-margin=\"true\">\n            <ix-row>\n              {this.dateRangeOptions?.length > 1 && (\n                <ix-col\n                  class={{\n                    'no-margin': true,\n                    'border-right': this.selectedDateRangeId === 'custom',\n                  }}\n                >\n                  {this.dateRangeOptions.map((dateRangeOption) => (\n                    <ix-dropdown-item\n                      label={dateRangeOption.label}\n                      onClick={() => this.onRangeListSelect(dateRangeOption.id)}\n                      checked={this.selectedDateRangeId === dateRangeOption.id}\n                    ></ix-dropdown-item>\n                  ))}\n                  <div hidden={!this.customRangeAllowed}>\n                    <ix-dropdown-item\n                      label={this.i18nCustomItem}\n                      checked={this.selectedDateRangeId === 'custom'}\n                      onClick={() => this.onRangeListSelect('custom')}\n                    ></ix-dropdown-item>\n                  </div>\n                </ix-col>\n              )}\n              <ix-col class=\"no-margin\">\n                {this.selectedDateRangeId === 'custom' && (\n                  <Fragment>\n                    <ix-date-picker\n                      standaloneAppearance={false}\n                      onDateChange={(e) => {\n                        e.stopPropagation();\n                        this.currentRangeValue = {\n                          ...e.detail,\n                          id: 'custom',\n                        };\n                        this.datePickerTouched = true;\n                      }}\n                      onDateRangeChange={(e) => e.stopPropagation()}\n                      format={this.format}\n                      range={this.range}\n                      from={this.from || this.currentRangeValue?.from}\n                      to={this.to || this.currentRangeValue?.to}\n                      minDate={this.minDate}\n                      maxDate={this.maxDate}\n                      today={this.today}\n                    ></ix-date-picker>\n                    <div class=\"pull-right\">\n                      <ix-button\n                        onClick={() => {\n                          this.onDateSelect(this.currentRangeValue);\n                        }}\n                      >\n                        {this.i18nDone}\n                      </ix-button>\n                    </div>\n                  </Fragment>\n                )}\n              </ix-col>\n            </ix-row>\n          </ix-layout-grid>\n        </ix-dropdown>\n      </Host>\n    );\n  }\n}\n"],"mappings":"2GAAA,MAAMA,EAAkB,woCACxB,MAAAC,EAAeD,E,MC4CFE,EAAY,M,0EAwIfC,KAAAC,kBAAoB,M,cAhIT,M,YAMF,a,WAKD,K,qGAkCM,S,wBAqBO,K,sBAeoB,G,oBAUS,Y,cAKb,O,iBAKO,e,WAGpCC,EAASC,MAAMC,Q,8FAvD/B,mBAAAC,GACEL,KAAKM,kBAAkBN,KAAKO,aAC5BP,KAAKQ,oBACLR,KAAKS,sBAAsBT,KAAKO,aAEhCP,KAAKU,aAAa,CAChBC,KAAMX,KAAKY,kBAAkBD,KAC7BE,GAAIb,KAAKY,kBAAkBC,GAC3BC,GAAId,KAAKY,kBAAkBE,I,CA0B/B,wBAAAC,GACEf,KAAKgB,aACLhB,KAAKK,qB,CAsCP,gBAAAY,GACE,GAAIjB,KAAKkB,SAAU,CACjBlB,KAAKmB,e,EAKT,iBAAAC,GACEpB,KAAKgB,aACLhB,KAAKS,sBAAsBT,KAAKO,Y,CAQ3B,kBAAMc,GACX,OAAOrB,KAAKY,iB,CAGN,UAAAI,GACN,MAAMM,EACJtB,KAAKO,cAAgB,WACnBP,KAAKO,eAAiBP,KAAKW,QAAUX,KAAKa,GAE9C,GAAIS,GAAiBtB,KAAKuB,mBAAoB,CAC5CvB,KAAKwB,oBAAsB,SAC3BxB,KAAKQ,oBAEL,M,CAEF,MAAMiB,GAAwBH,IAAkBtB,KAAKW,KACrD,IAAKc,EAAsB,CACzBC,QAAQC,KACN,0FAGF3B,KAAKwB,oBAAsB,SAC3BxB,KAAKQ,oBAEL,M,EAII,iBAAAA,GACNR,KAAKY,kBAAoB,CACvBE,GAAId,KAAKwB,oBACTb,KAAMX,KAAKW,KACXE,GAAIb,KAAKa,G,CAIL,YAAAH,CACNkB,EACAC,EAAmB,MAEnB7B,KAAK8B,gBAAgBC,KAAKH,GAE1B,GAAIC,EAAkB,CACpB7B,KAAKmB,e,CAGPnB,KAAKC,kBAAoB,K,CAGnB,iBAAAK,CAAkBQ,GACxB,GAAId,KAAKS,sBAAsBK,GAAK,CAClCd,KAAKU,aAAaV,KAAKY,kB,EAInB,qBAAAH,CAAsBK,GAC5Bd,KAAKwB,oBAAsBV,EAC3B,MAAMkB,EAAShC,KAAKiC,iBAAiBC,MAAMC,GAAUA,EAAMrB,KAAOA,IAElE,GAAIkB,EAAQ,CACVhC,KAAKY,kBAAoBoB,C,CAG3B,OAAOA,C,CAGD,aAAAb,GACNnB,KAAKoC,YAAYC,WAAWC,cAAc,eAAeC,KAAO,K,CAG1D,cAAAC,G,QACN,GAAIxC,KAAKwB,sBAAwB,YAAYiB,EAAAzC,KAAKY,qBAAiB,MAAA6B,SAAA,SAAAA,EAAE9B,MAAM,CACzE,IAAIwB,EAAQnC,KAAKY,kBAAkBD,KAEnC,GAAIX,KAAKY,kBAAkBC,GAAI,CAC7BsB,GAAS,MAAMnC,KAAKY,kBAAkBC,I,CAGxC,OAAOsB,C,CAGT,IAAKnC,KAAKwB,oBAAqB,CAC7B,OAAOxB,KAAK0C,W,CAGd,IAAK1C,KAAKiC,oBAAoBU,EAAA3C,KAAKiC,oBAAgB,MAAAU,SAAA,SAAAA,EAAEC,UAAW,EAAG,CACjE,OAAO5C,KAAK0C,W,CAGd,MAAMV,EAAShC,KAAKiC,iBAAiBC,MAClCF,GAAWA,EAAOlB,KAAOd,KAAKwB,sBAGjC,IAAKQ,EAAQ,CACXN,QAAQmB,MACN,oCAAoC7C,KAAKwB,uBAE3C,OAAOxB,KAAK0C,W,CAGd,OAAOV,EAAOc,K,CAGhB,MAAAC,G,UACE,OACEC,EAACC,EAAI,CAAAC,IAAA,4CACHF,EAAA,aAAAE,IAAA,yDACc,wBAAuB,kCAEnCC,QAAQ,UACRC,KAAK,UACLC,IAAMA,GAASrD,KAAKsD,WAAaD,EACjCnC,SAAUlB,KAAKkB,UAEdlB,KAAKwC,kBAERQ,EAAA,eAAAE,IAAA,yDACc,gBAAe,0BAE3BK,MAAM,uBACNC,QAASxD,KAAKsD,WACdG,cAAc,UACdC,UAAU,eACVC,cAAe,EAAGC,OAAQrB,MACxB,IACGA,GACDvC,KAAKwB,sBAAwB,UAC7BxB,KAAKC,kBACL,CACAD,KAAKU,aAAaV,KAAKY,kB,IAI3BoC,EAAA,kBAAAE,IAAA,uDAA0B,QACxBF,EAAA,UAAAE,IAAA,8CACGT,EAAAzC,KAAKiC,oBAAgB,MAAAQ,SAAA,SAAAA,EAAEG,QAAS,GAC/BI,EAAA,UAAAE,IAAA,2CACEK,MAAO,CACL,YAAa,KACb,eAAgBvD,KAAKwB,sBAAwB,WAG9CxB,KAAKiC,iBAAiB4B,KAAKC,GAC1Bd,EAAA,oBACEF,MAAOgB,EAAgBhB,MACvBiB,QAAS,IAAM/D,KAAKM,kBAAkBwD,EAAgBhD,IACtDkD,QAAShE,KAAKwB,sBAAwBsC,EAAgBhD,OAG1DkC,EAAA,OAAAE,IAAA,2CAAKe,QAASjE,KAAKuB,oBACjByB,EAAA,oBAAAE,IAAA,2CACEJ,MAAO9C,KAAKkE,eACZF,QAAShE,KAAKwB,sBAAwB,SACtCuC,QAAS,IAAM/D,KAAKM,kBAAkB,cAK9C0C,EAAA,UAAAE,IAAA,2CAAQK,MAAM,aACXvD,KAAKwB,sBAAwB,UAC5BwB,EAACmB,EAAQ,CAAAjB,IAAA,4CACPF,EAAA,kBAAAE,IAAA,2CACEkB,qBAAsB,MACtBC,aAAeC,IACbA,EAAEC,kBACFvE,KAAKY,kBAAiB4D,OAAAC,OAAAD,OAAAC,OAAA,GACjBH,EAAEV,QAAM,CACX9C,GAAI,WAENd,KAAKC,kBAAoB,IAAI,EAE/ByE,kBAAoBJ,GAAMA,EAAEC,kBAC5BI,OAAQ3E,KAAK2E,OACbxC,MAAOnC,KAAKmC,MACZxB,KAAMX,KAAKW,QAAQgC,EAAA3C,KAAKY,qBAAiB,MAAA+B,SAAA,SAAAA,EAAEhC,MAC3CE,GAAIb,KAAKa,MAAM+D,EAAA5E,KAAKY,qBAAiB,MAAAgE,SAAA,SAAAA,EAAE/D,IACvCgE,QAAS7E,KAAK6E,QACdC,QAAS9E,KAAK8E,QACdC,MAAO/E,KAAK+E,QAEd/B,EAAA,OAAAE,IAAA,2CAAKK,MAAM,cACTP,EAAA,aAAAE,IAAA,2CACEa,QAAS,KACP/D,KAAKU,aAAaV,KAAKY,kBAAkB,GAG1CZ,KAAKgF,gB"}